window.__require=function t(e,i,n){function s(a,r){if(!i[a]){if(!e[a]){var c=a.split("/");if(c=c[c.length-1],!e[c]){var l="function"==typeof __require&&__require;if(!r&&l)return l(c,!0);if(o)return o(c,!0);throw new Error("Cannot find module '"+a+"'")}a=c}var h=i[a]={exports:{}};e[a][0].call(h.exports,function(t){return s(e[a][1][t]||t)},h,h.exports,t,e,i,n)}return i[a].exports}for(var o="function"==typeof __require&&__require,a=0;a<n.length;a++)s(n[a]);return s}({AudioControl:[function(t,e){"use strict";cc._RF.push(e,"95908qUR6FL7a1t7vJkAGPF","AudioControl"),window.AudioContext=window.AudioContext||window.webkitAudioContext,cc.Class({extends:cc.Component,properties:{voiceLevel:0,_inited:!1,_audioContext:null,_audioInput:null,_analyserNode:null,_freqByteData:null},onLoad:function(){},initAudio:function(){this._audioContext=new AudioContext,navigator.getUserMedia||(navigator.getUserMedia=navigator.webkitGetUserMedia||navigator.mozGetUserMedia),navigator.cancelAnimationFrame||(navigator.cancelAnimationFrame=navigator.webkitCancelAnimationFrame||navigator.mozCancelAnimationFrame),navigator.requestAnimationFrame||(navigator.requestAnimationFrame=navigator.webkitRequestAnimationFrame||navigator.mozRequestAnimationFrame);var t=this;navigator.getUserMedia({audio:{mandatory:{googEchoCancellation:"false",googAutoGainControl:"false",googNoiseSuppression:"false",googHighpassFilter:"false"},optional:[]}},function(e){var i=t._audioContext,n=i.createGain(),s=i.createMediaStreamSource(e);s.connect(n);var o=i.createAnalyser();o.fftSize=2048,n.connect(o);var a=new Uint8Array(o.frequencyBinCount);o.getByteFrequencyData(a),t._freqByteData=a,t._analyserNode=o,t._audioInput=s,t._inited=!0},function(e){alert("Error getting audio"),console.log(e),t._inited=!1})},update:function(){if(this._inited){var t=this._analyserNode,e=this._freqByteData;t.getByteFrequencyData(e);for(var i=0,n=0;n<e.length;n++)i+=e[n];this.voiceLevel=i/e.length}},closeAudio:function(){this._audioContext&&this._audioContext.close()}}),cc._RF.pop()},{}],BackgroundAdapter:[function(t,e,i){"use strict";cc._RF.push(e,"e3327bazAZKJqFQnUJ6pTHM","BackgroundAdapter"),Object.defineProperty(i,"__esModule",{value:!0});var n=cc._decorator,s=n.ccclass,o=(n.property,function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.onLoad=function(){var t=Math.min(cc.view.getCanvasSize().width/this.node.width,cc.view.getCanvasSize().height/this.node.height),e=this.node.width*t,i=this.node.height*t;this.node.scale=Math.max(cc.view.getCanvasSize().width/e,cc.view.getCanvasSize().height/i)},__decorate([s],e)}(cc.Component));i.default=o,cc._RF.pop()},{}],ContentAdapter:[function(t,e,i){"use strict";cc._RF.push(e,"9f7d4ToR2ZAUoY/WUypvuCT","ContentAdapter"),Object.defineProperty(i,"__esModule",{value:!0});var n=cc._decorator,s=n.ccclass,o=(n.property,function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.onLoad=function(){var t=Math.min(cc.view.getCanvasSize().width/this.node.width,cc.view.getCanvasSize().height/this.node.height),e=this.node.width*t,i=this.node.height*t;this.node.width=this.node.width*(cc.view.getCanvasSize().width/e),this.node.height=this.node.height*(cc.view.getCanvasSize().height/i)},__decorate([s],e)}(cc.Component));i.default=o,cc._RF.pop()},{}],LoadingNode:[function(t,e){"use strict";cc._RF.push(e,"99164skwP1HA6UI/OLpjAY2","LoadingNode");var i=t("Utils");cc.Class({extends:cc.Component,properties:{stepNodes:[cc.Node],mouthNode:cc.Node,rateMask:cc.Node,spriteFrames:[cc.SpriteFrame],wordLabel:cc.Label},onLoad:function(){cc.systemEvent.on("VOICEPROCESSING",this.handSpeakListening,this)},handSpeakListening:function(t){var e=t.getUserData();if(e.suc)if(console.log(e.data.SuggestedScore),e.data.SuggestedScore>=50)if(this.wordsSpeakResult[this.currentStep]=1,this.stepNodes[this.currentStep].getChildByName("icon_right").active=!0,this.currentStep++,this.rateMask.width=260.3854*this.currentStep,this.rateMask.width>1562&&(this.rateMask.width=1562),this.currentStep==this.wordsArray.length){var i=new cc.Event.EventCustom("GO_GAME",!0);cc.systemEvent.dispatchEvent(i)}else this.newListen();else this.newListen();else this.newListen()},start:function(){var t=this,e=["strawberry","peach","banana","watermelon","apple","cherry","kiwi","lemon","orange","pear","dragon fruit","coconut"],n=["strawberry","peach","banana","watermelon","apple","cherry","kiwi","lemon","orange","pear","dragon fruit","coconut"];this.wordsArray=i.utils.randomArray(e,6),this.wordsSpeakResult=[0,0,0,0,0,0];for(var s=0;s<this.wordsArray.length;s++){var o=this.wordsArray[s];console.log(o,e.indexOf(o)),this.stepNodes[s].getChildByName("bg_wt").getChildByName("apple_01").getComponent(cc.Sprite).spriteFrame=this.spriteFrames[n.indexOf(o)],this.stepNodes[s].getChildByName("icon_right").active=!1}this.currentStep=0,this.checkNext=!0,cc.tween(this.node).delay(2).call(function(){t.startRecordVoice()}).delay(2).call(function(){t.stopRecordVoice()}).start()},newListen:function(){var t=this;cc.tween(this.node).call(function(){t.startRecordVoice()}).delay(2).call(function(){t.stopRecordVoice()}).start()},startRecordVoice:function(){this.voiceStart="RECORDING",this.mouthNode.getComponent(cc.Animation).play("mouth"),this.wordLabel.string=this.wordsArray[this.currentStep],window.startVoiceRecord(this.wordsArray[this.currentStep])},stopRecordVoice:function(){this.voiceStart="PROCESSING",this.mouthNode.getComponent(cc.Animation).stop(),window.stopVoiceRecord()}}),cc._RF.pop()},{Utils:"Utils"}],Main:[function(t,e){"use strict";cc._RF.push(e,"9b163r2ZnBGRYOih7S0bkT4","Main"),cc.Class({extends:cc.Component,properties:{loadingNode:cc.Node,gameNode:cc.Node,startNode:cc.Node},onLoad:function(){cc.systemEvent.on("GO_GAME",this.goGame,this)},start:function(){this.startNode.active=!0,this.loadingNode.active=!1,this.gameNode.active=!1},goLoading:function(){this.startNode.active=!1,this.loadingNode.active=!0,this.gameNode.active=!1,window.createRecorder()},goGame:function(){cc.sys.isNative?jsb.startHandTracking()&&(this.startNode.active=!1,this.loadingNode.active=!1,this.gameNode.active=!0):(this.startNode.active=!1,this.loadingNode.active=!1,this.gameNode.active=!0,window.startTracking())}}),cc._RF.pop()},{}],UIUtils:[function(t,e,i){"use strict";function n(){this.shakeArr=[[1,1],[-1,-1],[-1,1],[1,-1]],this.countDown=function(t,e,i){var n=t+1;null!=t&&0!=t&&(e.unscheduleAllCallbacks(),e.schedule(function(){--n>=0?e.string=n:(i&&i(),e.unscheduleAllCallbacks())},1))},this.scaleRepeat=function(t,e,i,n){if(void 0===e&&(e=.8),void 0===i&&(i=1.2),void 0===n&&(n=1),null!=t){var s=t.scaleX,o=t.scaleY;t.scaleX=s*e,t.scaleY=o*e,t.runAction(cc.repeatForever(cc.sequence(cc.scaleTo(n,s*i,o*i),cc.scaleTo(n,s*e,o*e))))}},this.fadeRepeat=function(t,e,i,n){void 0===e&&(e=0),void 0===i&&(i=255),void 0===n&&(n=1),null!=t&&(t.opacity=e,t.runAction(cc.repeatForever(cc.sequence(cc.fadeTo(n,i),cc.fadeTo(n,e)))))},this.fadeOver=function(t,e,i){void 0===e&&(e=0),void 0===i&&(i=1),null!=t&&t.runAction(cc.fadeTo(i,e))},this.showText=function(t,e,i,n){if(void 0===i&&(i=.1),null!=t&&""!=e&&0!=e.length){if(1==e.length)return t.unscheduleAllCallbacks(),t.isRunShowText=!1,n&&n(),void(t.string=e);t.string="",t.unscheduleAllCallbacks(),t.isRunShowText=!0,t.context=e,t.schedule(s,i),s()}function s(){var i=t.string?t.string.length:0;if(i<e.length){var s=e.substring(i);"<"==s.substring(0,1)&&(i+=s.indexOf(">"),i+=(s=e.substring(i+1)).indexOf(">")),t.string=e.substring(0,i+1)}else t.unscheduleAllCallbacks(),t.isRunShowText=!1,n&&n()}},this.showNumChange=function(t,e,i,n,s,o,a,r){function c(){var c=t.numIndex++,l=e+Math.floor((i-e)/n*c);l=c>=n?i:l;var h=r?utils.utils.formatMoney(l):l+"";if(s)if(o){var u={};u[o]=h,h=i18n.t(s,u)}else h=i18n.t(s)+" "+h;t.string=h,c>=n&&(t.unscheduleAllCallbacks(),a&&a())}void 0===n&&(n=30),void 0===r&&(r=!0),null!=t&&(e!=i?(t.numIndex=1,t.unscheduleAllCallbacks(),t.schedule(c,.04),c()):(t.numIndex=n,c()))},this.showProgressBarChange=function(t,e,i,n,s,o){var a=(i-e)/(n/.04);t.progress=e,t.schedule(function(){t.progress+a<i?t.progress=i:t.progress+=a,t.progress<=i&&(t.unscheduleAllCallbacks(),void 0!==s&&(void 0!==o?s(o):s()))},.04)},this.showPrgChange=function(t,e,i,n,s,o){function a(){var a=t.numIndex++,r=e+(i-e)/s*(a%s+1);r=(r=r<.05?0:r)>1?1:r,t.progress=r,a+1>=s*n&&(t.unscheduleAllCallbacks(),o&&o())}void 0===e&&(e=0),void 0===i&&(i=1),void 0===n&&(n=1),void 0===s&&(s=30),null!=t&&(s=s,n=n,e=e,i=null!=i?i:1,t.progress=e,e!=i&&(t.numIndex=1,t.unscheduleAllCallbacks(),t.schedule(a,.04),a()))},this.getRwd=function(t){for(var e=new Array,i=t.split(","),n=0;n<i.length;n++){var o=i[n].split("|"),a=new s;a.id=o.length>0?parseInt(o[0]):0,a.count=o.length>1?parseInt(o[1]):0,a.kind=o.length>2?parseInt(o[2]):0,e.push(a)}return e},this.getRwdItem=function(t){for(var e=new Array,i={},n=0;t&&n<t.length;n++){var s=t[n].itemid;1!=i[s]&&(i[s]=1,e.push({id:s}))}return e},this.getItemNameCount=function(t,e){var i=localcache.getItem(localdb.table_item,t);return i18n.t("COMMON_ADD",{n:i?i.name:"",c:e})},this.moveNodeAction=function(t,e,i,n){var s=t.getPosition().x,o=t.getPosition().y,a=e.x,r=e.y,c=a+(s-a)/2+50,l=r+(o-r)/2+10,h=[];h.push(new cc.Vec2(s,o)),h.push(new cc.Vec2(c,l)),h.push(new cc.Vec2(a,r));var u=cc.bezierTo(i,h),d=cc.callFunc(function(){n&&n()}),_=cc.sequence(u,d);t.runAction(_)},this.showShake=function(t,e,i,n){if(void 0===e&&(e=4),void 0===i&&(i=12),null!=t){var s=this;t.orgx?(t.node.x=t.orgx,t.node.y=t.orgy):(t.orgx=t.node.x,t.orgy=t.node.y),t.numIndex=1,t.unscheduleAllCallbacks(),t.schedule(o,.04),o()}function o(){var o=t.numIndex++,a=(i-o)/i,r=o%4;t.node.x=s.shakeArr[r][0]*a*e+t.orgx,t.node.y=s.shakeArr[r][1]*a*e+t.orgy,o>=i&&(t.node.x=t.orgx,t.node.y=t.orgy,t.unscheduleAllCallbacks(),n&&n())}},this.showShakeNode=function(t,e,i,n){if(void 0===e&&(e=4),void 0===i&&(i=12),null!=t){var s=t.getComponent(cc.Component);s&&this.showShake(s,e,i,n)}},this.floatPos=function(t,e,i,n){void 0===e&&(e=0),void 0===i&&(i=0),void 0===n&&(n=1),null!=t&&(t.orgx?(t.x=t.orgx,t.y=t.orgy):(t.orgx=t.x,t.orgy=t.y),t.x=t.orgx+e,t.y=t.orgy+i,t.runAction(cc.repeatForever(cc.sequence(cc.moveTo(n,t.orgx-e,t.orgy-i),cc.moveTo(n,t.orgx+e,t.orgy+i)))))},this.changeTwoDigits=function(t){return t>=10?t+"":"0"+t},this.getCountDownStr=function(t){if(null==t)return"00:00";var e=Math.floor(t/3600),i=Math.floor((t-3600*e)/60),n=Math.floor(t-3600*e-60*i);return t>=3600?this.changeTwoDigits(e)+":"+this.changeTwoDigits(i):this.changeTwoDigits(i)+":"+this.changeTwoDigits(n)},this.getPosDistance=function(t,e){return Math.sqrt(e.x-t.x^e.y-t.y+2^2)}}cc._RF.push(e,"ad456R+O51F5KZuDK2Y4NoH","UIUtils"),i.UIUtils=n,i.uiUtils=new n,cc._RF.pop()},{}],Utils:[function(e,i,n){"use strict";function s(){this.randomArray=function(t,e){if(t.length<e){var i=t.length,n=e-i,s=Math.floor(n/i);if(s>0){for(var o=0;o<s;o++)t.forEach(function(e){t.push(e)});var a=e-i*s;if(a>0)for(var r=0;r<a;r++){var c=Math.floor(t.length*Math.random());t.push(t[c])}}else for(var l=0;l<n;l++){var h=Math.floor(t.length*Math.random());t.push(t[h])}}return t.sort(function(){return 10*Math.random()<5?1:-1}),t.slice(0,e)},this.arrayRemove=function(t,e){var i=t.indexOf(e);i>-1&&(t=t.splice(i,1))},this.getPicPath=function(t){return 1==t.length?"pic/"+t+t+"/"+t:"pic/"+t.substring(0,2)+"/"+t},this.getVideoPath=function(t){return"mp4/"+t},this.dispatchCustormEvent=function(t,e){var i=new cc.Event.EventCustom(t,!0);i.setUserData(e),cc.systemEvent.dispatchEvent(i)},this.loadPic=function(t,e){var i=this.getPicPath(t);this.load(null,i,null,!1,!1,e)},this.load=function(t,e,i,n,s,o){var a=this;console.log("url="+e),void 0===n&&(n=!1),void 0===s&&(s=!1),e.indexOf("preb/")>-1?cc.resources.load(e,function(e,o){if(e)cc.log("Error url ["+e+"]");else if(t){var r=cc.instantiate(o);r.setPosition(0,0),void 0!==i&&null!=i&&(r.openParam=i,void 0!==i.pos&&r.setPosition(i.pos.x,i.pos.y)),r.openTime=cc.sys.now(),t.addChild(r),s?a.setTopIndex(r):a.setBottomIndex(r),n&&a.showNodeEffect(r)}}):e.indexOf("gamelib/")>-1?cc.resources.load(e,function(e,i){e?cc.log("Error url ["+e+"]"):null!=o&&null!=t?o.apply(t,[i.json]):null!=o&&o(i.json)}):e.indexOf("pic/")>-1?cc.resources.load(e,cc.SpriteFrame,function(i,n){i?cc.log("Error url ["+i+"]",e):null!=o&&null!=t?o.apply(t,n):null!=o&&o(n)}):(e.indexOf("http://")>-1||e.indexOf("https://")>-1)&&cc.assetManager.loadRemote(e,function(i,n){i?cc.log("Error url ["+i+"]",e):null!=o&&null!=t?o.apply(t,n):null!=o&&o(n)})},this.openAlertUI=function(t,e){this.load(t,"preb/AlertUI",e,!1,!0,null)},this.close=function(t){t.node.destroy(),t.node.removeFromParent(!0)},this.closeListNode=function(t){if(t&&t.length>0)for(var e=0;e<t.length;e++)t[e].destroy(),t[e].removeFromParent(!0)},this.setTopIndex=function(t){t&&t.parent&&t.setSiblingIndex(t.parent.childrenCount-1)},this.setBottomIndex=function(t){t&&t.parent&&t.setSiblingIndex(0)},this.showNodeEffect=function(t,e){if(void 0===e&&(e=-1),null!=t){var i=t.getComponent(cc.Animation);if(i){var n=i.getClips();-1==e&&(e=Math.floor(Math.random()*n.length)),-1!=e&&n.length>2&&n.length%2==0&&(e+=2*Math.floor(Math.random()*n.length/2));var s=n[e];s&&i.play(s.name)}}}}function o(){this._bgm=-1,this._bgmCurrent=null,this._soundLoads={},this._isSoundOff=!1,this._isPlaySound=!1,this._bgmVolume=1,this._lastSound=-1,this.playEffect=function(t){this.playSound(t,!1,!0,null,"effect")},this._getSoundPath=function(t,e){if("cn"==e||"en"==e||"py"==e||"math"==e){"math"==e&&(e="cn");var i=t;return 1==i.length&&(i+=i),"sound/lib/"+e+"/"+i.substring(0,2)+"/"+t}return"sound/"+e+"/"+t},this.sound_json=null,this.storagePath="",this.setBGMVolume=function(t){this._bgmVolume=t,this.updateBGMVolume()},this.setSoundOff=function(t){this._isSoundOff=t,this.updateBGMVolume()},this.getSoundOff=function(){return this._isSoundOff},this.updateBGMVolume=function(){-1!=this._bgm&&(cc.audioEngine.setVolume(this._bgm,this._isPlaySound?.2:this._bgmVolume),cc.audioEngine.setVolume(this._bgm,this._isSoundOff?0:this._bgmVolume))},this.playBGM=function(t){var e=this;if(!n.stringUtil.isBlank(t)||this._bgmCurrent!=t){this.stopBGM();var i=this._getSoundPath(t,"bgm");cc.resources.load(i,cc.AudioClip,null,function(n,s){n?cc.warn("Error "+i+" ["+n+"]"):(e._bgmCurrent=t,e._bgm=cc.audioEngine.playMusic(s,!0),e.updateBGMVolume())})}},this.stopBGM=function(){this._bgm>=0&&(cc.audioEngine.stop(this._bgm),this._bgm=-1,this._bgmCurrent=null)},this.isPlayLastSound=function(){return-1!=this._lastSound},this.playSounds=function(t,e){var i=this;if(void 0!==t&&t.length>0){var n=this._getSoundPath(t[0],e);cc.resources.load(n,cc.AudioClip,null,function(t,e){t?cc.warn("Error "+n+" ["+t+"]"):(i._lastSound=cc.audioEngine.play(e,!1,i._bgmVolume),console.log("play=>"+name+",id=>"+i._lastSound),cc.audioEngine.setFinishCallback(i._lastSound,function(){cc.sys.isBrowser||cc.audioEngine.uncache(n),i._lastSound=-1,i._isPlaySound=!1,i.updateBGMVolume(),null!=callBack&&callBack()}))})}},this.playSound=function(t,e,i,s,o){var a=this;if(!n.stringUtil.isBlank(t)){i&&this.updateBGMVolume(),e&&(this._isPlaySound=!0,this.stopLastSound());var r=this._getSoundPath(t,o);cc.resources.load(r,cc.AudioClip,null,function(t,i){if(t)cc.warn("Error "+r+" ["+t+"]");else{var n=cc.audioEngine.play(i,!1,a._bgmVolume);e&&(a._lastSound=n),cc.audioEngine.setFinishCallback(n,function(){cc.sys.isBrowser||cc.audioEngine.uncache(r),e&&(a._lastSound=-1,a._isPlaySound=!1),a.updateBGMVolume(),null!=s&&s()})}})}},this.stopLastSound=function(){-1!=this._lastSound&&(console.log("stop=>"+this._lastSound),cc.audioEngine.stop(this._lastSound))},this.playClickSound=function(){this._isSoundOff||cc.audioEngine.play(this._getSoundPath(config.Config.clickBtnSound),!1,this._bgmVolume)},this.getStoragePath=function(){return""==this.storagePath&&(this.storagePath=(jsb.fileUtils?jsb.fileUtils.getWritablePath():"/")+"update-assets"),this.storagePath},this.isExitManifest=function(){return null!=this.sound_json},this.loadMainifest=function(){if(!cc.sys.isBrowser)if(null==this.sound_json){console.log("\u5f00\u59cb\u4e0b\u8f7d\u8bed\u97f3"),this.storagePath=(jsb.fileUtils?jsb.fileUtils.getWritablePath():"/")+"update-assets";var t=this.storagePath+"/res/raw-assets/resources/"+config.Config.skin+"/res/sound.json",e=this;jsb.fileUtils.isFileExist(t)?cc.loader.load(t,function(t,i){null==t?(e.sound_json=i,console.log("e.sound_json is "+e.sound_json),facade.send("LOAD_MANIFEST_OVER",null,!0)):n.alertUtil.alert(t.toString())}):(t=config.Config.skin+"/res/sound",cc.loader.loadRes(t,function(t,i){null==t?(e.sound_json=i,console.log("e.sound_json is "+e.sound_json),facade.send("LOAD_MANIFEST_OVER",null,!0)):n.alertUtil.alert(t.toString())}))}else facade.send("LOAD_MANIFEST_OVER")},this.isNeedDown=function(){return!cc.sys.isBrowser&&("1"==cc.sys.localStorage.getItem("DOWN_SOUND")||!jsb.fileUtils.isDirectoryExist(cc.url.raw("resources/"+config.Config.skin+"/res/audio_down/"))&&(this.storagePath=(jsb.fileUtils?jsb.fileUtils.getWritablePath():"/")+"update-assets",!jsb.fileUtils.isDirectoryExist(this.storagePath+"/res/raw-assets/resources/"+config.Config.skin+"/res/audio_down/")))},this.isNeedDownType=function(t,e){if(cc.sys.isBrowser)return!1;if(null==this.sound_json)return this.loadMainifest(),!1;var i=this.getLoadItems(t,e);return i&&i.length>0},this.getLoadItems=function(t,e){var i=localcache.getList(localdb.table_voiceDown),n=[];if(cc.sys.isBrowser)return null;cc.log(t,e);var s=jsb.fileUtils.isDirectoryExist(cc.url.raw("resources/"+config.Config.skin+"/res/audio_down/"));if(0==t)for(var o in this.sound_json.assets){var a=this.storagePath+"/"+o,r=this.sound_json.assets[o],c=o.replace("res/raw-assets/",""),l=cc.url.raw(c);jsb.fileUtils.isFileExist(a)||null==r||s&&jsb.fileUtils.isFileExist(l)||n.push({key:o,item:r})}else for(var h=0;h<i.length;h++)i[h].type==t&&e==i[h].para&&(o="res/raw-assets/resources/"+config.Config.skin+"/res/audio_down/"+i[h].id+".mp3",a=this.storagePath+"/"+o,l=cc.url.raw("resources/"+config.Config.skin+"/res/audio_down/"+i[h].id+".mp3"),r=this.sound_json.assets[o],jsb.fileUtils.isFileExist(a)||null==r||s&&jsb.fileUtils.isFileExist(l)||n.push({key:o,item:r}));return n}}function a(){this.isMobile=function(t){return/^((13[0-9])|(14[5,7,9])|(15[0-3,5-9])|(166)|(17[3,5,6,7,8])|(18[0-9])|(19[8,9]))\d{8}$/.test(t)||/^(5|6|8|9)\\d{7}$/.test(t)},this.trim=function(t){return t.replace(/(^\s*)|(\s*$)/g,"")},this.isBlank=function(t){return null==t||""==t||" "==t||"null"==t||"undefined"==t},this.hasLimit=function(t){for(var e=["|","#","<",">","%","*","/","\\","="],i=0,n=e.length;i<n;i++)if(t.indexOf(e[i])>=0)return!0;return!1},this.hasBlank=function(t){for(var e=["\n","\r","\t","\f"," ","\u3000"],i=0,n=e.length;i<n;i++)if(t.indexOf(e[i])>=0)return!0;return!1},this.hasEmoji=function(t){return t.indexOf("\ud83c")>=0||t.indexOf("\ud83d")>=0}}function r(){this.perDayMicoSeconds=864e5,this.fix2=function(t){return t<10?"0"+t:""+t},this.getCurDateArray=function(t){var e=null;return[(e=void 0!==t?new Date(t.replace(/-/g,"/")):new Date).getFullYear(),e.getMonth()+1,e.getDate(),e.getDay()]},this.str2date=function(t){return void 0!==t&&t?new Date(t.replace(/-/g,"/")):new Date},this.formatArray2Str=function(t,e,i){return t+"-"+this.fix2(e)+"-"+this.fix2(i)},this.timeStamp2strDate=function(t){return new Date(t)},this.getDay=function(t,e){var i=t,n=i.getTime(),s=this.perDayMicoSeconds*e;i.setTime(parseInt(n+s));var o=i.getFullYear(),a=(i.getMonth()+1).toString();a.length<=1&&(a="0"+a);var r=i.getDate().toString();return r.length<=1&&(r="0"+r),o+separator+a+separator+r},this.getYearBegin=function(t){var e=new Date(t.getTime());return e.setDate(1),e.setMonth(0),this.setDayBegin(e),e},this.setDayBegin=function(t){t.setHours(0),t.setMinutes(0),t.setSeconds(0),t.setMilliseconds(0)},this.getDateDiff=function(t,e){this.setDayBegin(t),this.setDayBegin(e);var i=t.getTime(),n=e.getTime()-i,s=Math.floor(n/this.perDayMicoSeconds);return s>=0&&(s+=1),s},this.getTimeDataFun=function(t,e){var i=new Date(t,e,0),n=i.getDate();i.setDate(1);var s=i.getDay(),o=this.isLeapYear(t);return 2==e&&(n=o?29:28),{firstDayWeekNum:s,maxDay:n}},this.isLeapYear=function(t){return t%4==0&&t%100!=0||t%400==0},this.getYearDay=function(t){for(var e=new Array(31,28,31,30,31,30,31,31,30,31,30,31),i=t,n=i.getDate(),s=i.getMonth(),o=i.getFullYear(),a=0,r=0;r<s;r++)a+=e[r];return a+=n,s>1&&this.isLeapYear(o)&&(a+=1),a},this.getAge=function(t){var e,i=new Date(t),n=i.getFullYear(),s=i.getMonth()+1,o=i.getDate(),a=new Date,r=a.getFullYear(),c=a.getMonth()+1,l=a.getDate(),h=c-1>0?c-1:12;e=[1,3,5,7,8,10,12].indexOf(h)>-1?31:2===h?this.isLeapYear(r)?29:28:30;var u=r-n,d=c-s,_=l-o;_<0&&(_+=e,d--),d<0&&(u--,d+=12);var f="";return u>0&&(f+=u+"\u5c81"),d>0&&(f+=d+"\u4e2a\u6708"),f}}function c(){this.isPlaying=!1,this.alertPrefabmap={},this.alertList=new Array,this.alertText=function(t,e){void 0!==t&&null!=t&&t.length>0&&this.alertBy("TipsUI",{text:t,textColor:e})},this.alertBy=function(t,e){var i=this;if(null!=this.alertPrefabmap[t])this.alertShow(t,e);else{var n="preb/"+t;cc.resources.load(n,function(n,s){n?cc.log("Error url ["+n+"]"):(i.alertPrefabmap[t]=s,i.alertShow(t,e))})}},this.alertShow=function(e,i){var n=cc.instantiate(this.alertPrefabmap[e]);if(n){n.y=100,n.x=0;var s=n.getComponent(e);for(var o in i)s[o]=i[o];this.alertAddToQueueOneByOne(n,s)}else cc.warn("alert show "+t+" is error!!!")},this.alertAddToQueueOneByOne=function(t,e){var i=this;e.endCall=function(){i.alertList.splice(i.alertList.indexOf(e),1)},this.alertList.push(e);var n=this.alertList.indexOf(e);t.getComponent(cc.Animation).play(),cc.tween(t).delay(.5*n).call(function(){cc.director.getScene().getChildByName("Canvas").addChild(t)}).to(3,{position:new cc.Vec2(0,t.y+300)}).call(function(){i.alertList.splice(i.alertList.indexOf(e),1),cc.director.getScene().getChildByName("Canvas").removeChild(t)}).start()}}cc._RF.push(i,"7c37aUR8qdGKaDusNmHwrDg","Utils"),n.Utils=s,n.utils=new s,n.AudioManager=o,n.audioManager=new o,n.StringUtil=a,n.stringUtil=new a,n.TimeUtil=r,n.timeUtil=new r,n.Alert=c,n.alertUtil=new c,cc._RF.pop()},{}],fruit:[function(t,e){"use strict";cc._RF.push(e,"33950Nt79tHgIA2DDXFgSvB","fruit"),cc.Class({extends:cc.Component,properties:{fruit_type:null,position_x:null,position_y:null,fruit_per_roate:0,fruit_all:{default:null,type:cc.Prefab},fruit_apart_1:{default:null,type:cc.Prefab},fruit_apart_2:{default:null,type:cc.Prefab},fruit_all_curent_angle:0,fruit_all_per_roate_angle:0,fruit_all_x_speed:0,fruit_all_y_speed:0,fruit_all_y_acc:.15,fruit_apart_x_speed:0,fruit_apart_y_speed:0,fruit_apart_y_acc:.17,fruit_apart_roate_angle:150,isBroken:!1,isActivate:!0,isAvailable:!0,game_manager:null},onLoad:function(){},start:function(){},reset_all_properties:function(){this.fruit_type=null,this.position_x=null,this.position_y=null,this.fruit_per_roate=0,this.fruit_all=null,this.fruit_apart_1=null,this.fruit_apart_2=null,this.fruit_all_curent_angle=0,this.fruit_all_per_roate_angle=0,this.fruit_all_x_speed=0,this.fruit_all_y_speed=0,this.fruit_all_y_acc=.15,this.fruit_apart_x_speed=0,this.fruit_apart_y_speed=0,this.fruit_apart_y_acc=.17,this.fruit_apart_roate_angle=150,this.isBroken=!1,this.isActivate=!0},set_properties:function(t,e,i,n,s,o,a,r,c){this.fruit_type=t,this.fruit_all=e,this.fruit_apart_1=i,this.fruit_apart_2=n,this.fruit_apart_roate_angle=-150*Math.random()-50,this.fruit_all_per_roate_angle=s,this.position_x=o,this.position_y=a,this.fruit_all_x_speed=r,this.fruit_all_y_speed=c,this.position_x&&this.position_y&&(this.fruit_all.x=this.position_x,this.fruit_all.y=this.position_y),"boom"==this.fruit_type&&(this.game_manager.boom_flame_schedule=function(){if(Math.random()<.9){var t=this.game_manager.getPooledBoomFlame(this.game_manager.gid++,.2+.5*Math.random(),[this.fruit_all.x+this.game_manager.node_w/2-this.game_manager.boom.width/2+3,this.fruit_all.y+this.game_manager.node_h/2+this.game_manager.boom.height/2-3],2*Math.PI*Math.random(),60,this.game_manager.global_timer,cc.instantiate(this.game_manager.paint));this.game_manager.node.addChild(t.paint)}for(var e in this.game_manager.pooled_boom_flame)0==this.game_manager.pooled_boom_flame[e].active&&(this.game_manager.pooled_boom_flame[e].elapse=this.game_manager.global_timer-this.game_manager.pooled_boom_flame[e].create_time,this.game_manager.pooled_boom_flame[e].update_boom_flame(this.game_manager.drawLine.bind(this.game_manager)))},this.schedule(this.game_manager.boom_flame_schedule.bind(this),.04)),this.game_manager.node.addChild(this.fruit_all)},fruit_up_down:function(){this.fruit_all.x+=this.fruit_all_x_speed,this.fruit_all_y_speed-=this.fruit_all_y_acc,this.fruit_all.y+=this.fruit_all_y_speed},apart:function(){if(this.isBroken=!0,"boom"!=this.fruit_type){cc.log("apart"),this.fruit_apart_1.x=this.fruit_all.x,this.fruit_apart_1.y=this.fruit_all.y,this.fruit_apart_2.x=this.fruit_all.x,this.fruit_apart_2.y=this.fruit_all.y,this.fruit_apart_1.angle=this.fruit_all.angle,this.fruit_apart_2.angle=this.fruit_all.angle;var t=Math.sign((this.fruit_all_curent_angle-90)*(270-this.fruit_all_curent_angle%360)+1e-10);this.fruit_apart_x_speed=(1.5*Math.random()+3.5)*t,this.fruit_apart_roate_angle=(150*Math.random()+50)*t,this.fruit_all.parent.removeChild(this.fruit_all),this.fruit_all=null,this.fruit_apart_1.runAction(cc.rotateBy(1,this.fruit_apart_roate_angle)),this.fruit_apart_2.runAction(cc.rotateBy(1,-this.fruit_apart_roate_angle)),this.game_manager.node.addChild(this.fruit_apart_1),this.game_manager.node.addChild(this.fruit_apart_2)}},update:function(){this.isBroken?"boom"!=this.fruit_type&&(this.fruit_apart_1.x+=this.fruit_apart_x_speed,this.fruit_apart_y_speed+=this.fruit_apart_y_acc,this.fruit_apart_1.y-=this.fruit_apart_y_speed,this.fruit_apart_2.x-=this.fruit_apart_x_speed,this.fruit_apart_y_speed+=this.fruit_apart_y_acc,this.fruit_apart_2.y-=this.fruit_apart_y_speed):(this.fruit_up_down(),"boom"!=this.fruit_type&&(this.fruit_all.angle+=this.fruit_all_per_roate_angle,this.fruit_all_curent_angle=Math.abs(this.fruit_all.angle)%360)),this.isActivate=!this.is_out_canvas()},is_out_canvas:function(){return this.isBroken?"boom"!=this.fruit_type?this.fruit_apart_1.y<this.game_manager.background.y-this.game_manager.node_h/2&&this.fruit_apart_2.y<this.game_manager.background.y-this.game_manager.node_h/2:void 0:this.fruit_all.y<this.game_manager.background.y-this.game_manager.node_h/2},fruit_destroy:function(){"boom"==this.fruit_type?(this.game_manager.removePooledBoomFlame(),this.unscheduleAllCallbacks(),this.fruit_all.parent.removeChild(this.fruit_all)):this.isBroken?(this.fruit_apart_1.parent.removeChild(this.fruit_apart_1),this.fruit_apart_2.parent.removeChild(this.fruit_apart_2)):this.fruit_all.parent.removeChild(this.fruit_all)}}),cc._RF.pop()},{}],knife:[function(t,e){"use strict";cc._RF.push(e,"4cb07KMaRBHgaFUp5Ey4gHo","knife"),cc.Class({extends:cc.Component,properties:{color:"#cbd3db",life:1,isActivate:!0,width:10,height:10},onLoad:function(){this.node.color=(new cc.Color).fromHEX(this.color)},start:function(){},set:function(){},resetProperties:function(){this.color="#cbd3db",this.life=1,this.isActivate=!0,this.width=10,this.height=10,this.node.width=this.width,this.node.height=this.height,this.node.angle=0},update:function(t){this.isActivate||(this.life-=t,this.node.width>0&&(this.node.width-=t/this.life*this.width))}}),cc._RF.pop()},{}],start:[function(t,e){"use strict";cc._RF.push(e,"ef949z6LxpCEY+chlHN+RkE","start");var i=t("fruit"),n=t("UIUtils");function s(t,e,i,n,o,a,r){this.id=t,this.create_time=a,this.life=e,this.center=i,this.angle=n,this.length=o,this.radius=15,this.elapse=0,this.paint=r,this.active=!0,s.prototype.set_properties=function(t,e,i,n,s,o,a){this.id=t,this.create_time=o,this.life=e,this.center=i,this.angle=n,this.length=s,this.radius=15,this.elapse=0,this.paint=a,this.active=!0},s.prototype.update_boom_flame=function(t){if(this.life-this.elapse<=0)this.remove_boom_flame();else{this.paint.getComponent(cc.Graphics).clear();var e=this.elapse/this.life,i=this.angle,n=this.center,s=this.length,o=this.radius;n=[Math.trunc(n[0]+s*e*Math.cos(i)),Math.trunc(n[1]+s*e*Math.sin(i))];var a=[Math.trunc(n[0]-o*(1-e)*Math.cos(i)),Math.trunc(n[1]-o*(1-e)*Math.sin(i))],r=[Math.trunc(n[0]+o*(1-e)*Math.cos(i)),Math.trunc(n[1]+o*(1-e)*Math.sin(i))],c=[Math.trunc(n[0]+o*(1-e)*Math.cos(i+.5*Math.PI)*.38),Math.trunc(n[1]+o*(1-e)*Math.sin(i+.5*Math.PI)*.38)],l=[Math.trunc(n[0]+o*(1-e)*Math.cos(i-.5*Math.PI)*.38),Math.trunc(n[1]+o*(1-e)*Math.sin(i-.5*Math.PI)*.38)];t(this.paint.getComponent(cc.Graphics),a,r,c,l)}},s.prototype.remove_boom_flame=function(){this.paint.getComponent(cc.Graphics).clear(),this.paint.destroy(),this.active=!0,this.id=null,this.create_time=null,this.life=null,this.center=null,this.angle=null,this.length=null,this.radius=null,this.elapse=null,this.paint=null}}function o(t,e,i,n,s){var o=Math.PI*(n*i-2.5)/180,a=Math.PI*(n*i+2.5)/180,r=t+1074*Math.cos(o),c=e+1074*Math.sin(o),l=t+1074*Math.cos(a),h=e+1074*Math.sin(a),u=s.getComponent(cc.Graphics);u.moveTo(t,e),u.lineTo(r,c),u.lineTo(l,h),u.close(),u.stroke(),u.fillColor=cc.Color.WHITE,u.fill()}cc.Class({extends:cc.Component,properties:{origin_bk_w:640,origin_bk_h:480,background:{default:null,type:cc.Node},scoreLabel:cc.Node,knife_part:{default:null,type:cc.Prefab},pooled_knifves:[],num_pooled_knifves:12,knife_width:10,knife_height:10,tryagain:cc.Node,finishScore:cc.Node,finishNode:cc.Node,_rotation:.7,prg:cc.ProgressBar,sx:null,sy:null,ex:null,ey:null,pooled_fruits:[],num_pooled_fruits:10,peach_prefab:{default:null,type:cc.Prefab},peach_part_1:{default:null,type:cc.Prefab},peach_part_2:{default:null,type:cc.Prefab},sandia_prefab:{default:null,type:cc.Prefab},sandia_part_1:{default:null,type:cc.Prefab},sandia_part_2:{default:null,type:cc.Prefab},banana_prefab:{default:null,type:cc.Prefab},banana_part_1:{default:null,type:cc.Prefab},banana_part_2:{default:null,type:cc.Prefab},basaha_prefab:{default:null,type:cc.Prefab},basaha_part_1:{default:null,type:cc.Prefab},basaha_part_2:{default:null,type:cc.Prefab},apple_prefab:{default:null,type:cc.Prefab},apple_part_1:{default:null,type:cc.Prefab},apple_part_2:{default:null,type:cc.Prefab},boom_prefab:{default:null,type:cc.Prefab},flash_prefab:{default:null,type:cc.Prefab},last_event_id:null,new_event_id:null,game_start_need:[cc.Node],game_score:0,fruit_missed:0,paint:{default:null,type:cc.Prefab},gid:0,pooled_boom_flame:[],num_pooled_boom_flame:20,global_timer:0,boom_is_broken:!1,blank_opacity:255,boom_audio:{default:null,type:cc.AudioClip},menu_audio:{default:null,type:cc.AudioClip},over_audio:{default:null,type:cc.AudioClip},start_audio:{default:null,type:cc.AudioClip},throw_audio:{default:null,type:cc.AudioClip},splatter_audio:{default:null,type:cc.AudioClip},tmpNode:{default:null,type:cc.Node},cherry_prefab:cc.Prefab,cherry_part_1:cc.Prefab,cherry_part_2:cc.Prefab,kiwi_prefab:cc.Prefab,kiwi_part_1:cc.Prefab,kiwi_part_2:cc.Prefab,lemon_prefab:cc.Prefab,lemon_part_1:cc.Prefab,lemon_part_2:cc.Prefab,orange_prefab:cc.Prefab,orange_part_1:cc.Prefab,orange_part_2:cc.Prefab,pear_prefab:cc.Prefab,pear_part_1:cc.Prefab,pear_part_2:cc.Prefab,pitaya_prefab:cc.Prefab,pitaya_part_1:cc.Prefab,pitaya_part_2:cc.Prefab,coconut_prefab:cc.Prefab,coconut_part_1:cc.Prefab,coconut_part_2:cc.Prefab},initConfig:function(){this.fruit_type=["strawberry","peach","banana","watermelon","apple","cherry","kiwi","lemon","orange","pear","pitaya","coconut"],this.config={strawberry:[this.sandia_prefab,this.sandia_part_1,this.sandia_part_2],peach:[this.peach_prefab,this.peach_part_1,this.peach_part_2],banana:[this.banana_prefab,this.banana_part_1,this.banana_part_2],watermelon:[this.basaha_prefab,this.basaha_part_1,this.basaha_part_2],apple:[this.apple_prefab,this.apple_part_1,this.apple_part_2],cherry:[this.cherry_prefab,this.cherry_part_1,this.cherry_part_2],kiwi:[this.kiwi_prefab,this.kiwi_part_1,this.kiwi_part_2],lemon:[this.lemon_prefab,this.lemon_part_1,this.lemon_part_2],orange:[this.orange_prefab,this.orange_part_1,this.orange_part_2],pear:[this.pear_prefab,this.pear_part_1,this.pear_part_2],pitaya:[this.pitaya_prefab,this.pitaya_part_1,this.pitaya_part_2],coconut:[this.coconut_prefab,this.coconut_part_1,this.coconut_part_2]}},drawLine:function(t,e,i,n,s){t.moveTo(e[0],e[1]),t.quadraticCurveTo(n[0],n[1],i[0],i[1]),t.quadraticCurveTo(s[0],s[1],e[0],e[1]),t.stroke(),t.fillColor=(new cc.Color).fromHEX("f0ef9c"),t.fill()},onLoad:function(){this.initConfig(),this.sandia=null,this.peach=null;for(var t=0;t<this.num_pooled_knifves;t++)this.pooled_knifves.push(cc.instantiate(this.knife_part));for(var e=0;e<this.num_pooled_fruits;e++)this.pooled_fruits.push(this.createFruit("none"));cc.director.getCollisionManager().enabled=!0,this.node.on(cc.Node.EventType.TOUCH_START,this.onTouchStart,this,!0),this.node.on(cc.Node.EventType.TOUCH_MOVE,this.onTouchMove,this,!0),this.node_h=this.node.height,this.node_w=this.node.width,console.log(this.node_h,",",this.node_w),this.knife_height=this.pooled_knifves[0].getComponent("knife").height,this.knife_width=this.pooled_knifves[0].getComponent("knife").width,cc.systemEvent.on("HAND_TRACKING",this.handTacking,this),this.node.on(cc.Node.EventType.MOUSE_MOVE,this.onHandTracking2Mouse,this,!0)},onHandTracking2Mouse:function(t){var e=t.getLocationX(),i=t.getLocationY();if(null==this.prev_pos){this.prev_pos=cc.v2(e,i),this.sx=this.prev_pos.x,this.sy=this.prev_pos.y;var n=this.getPooledKnife();this.node.addChild(n),n.setPosition(this.sx-this.node_w/2,this.sy-this.node_h/2)}else this.curent_pos=cc.v2(e,i),this.ex=this.curent_pos.x,this.ey=this.curent_pos.y,this.processEventForVR(),this.prev_pos=this.curent_pos,this.sx=this.prev_pos.x,this.sy=this.prev_pos.y},handTacking:function(t){var e=t.getUserData();console.log("handTacking="+JSON.stringify(e));var i=parseInt(parseFloat(e.x)*this.node.width),n=parseInt((1-parseFloat(e.y))*this.node.height);if(console.log(e,",x=",i,",y=",n),null==this.prev_pos){this.prev_pos=cc.v2(i,n),this.sx=this.prev_pos.x,this.sy=this.prev_pos.y;var s=this.getPooledKnife();this.node.addChild(s),s.setPosition(this.sx-this.node_w/2,this.sy-this.node_h/2)}else this.curent_pos=cc.v2(i,n),this.ex=this.curent_pos.x,this.ey=this.curent_pos.y,this.processEventForVR(),this.prev_pos=this.curent_pos,this.sx=this.prev_pos.x,this.sy=this.prev_pos.y},processEventForVR:function(){var t=this,e=this.curent_pos.sub(this.prev_pos).mag(),i=0,n=this.curent_pos.sub(this.prev_pos).signAngle(cc.v2(1,0))/Math.PI*180;if(e>this.knife_height){var s=cc.v2(0,10);i=this.curent_pos.sub(this.prev_pos).signAngle(s)/Math.PI*180;var o=this.getPooledKnife();null!=o&&(this.node.addChild(o),o.height=e,o.setPosition((this.sx+this.ex)/2-this.node_w/2,(this.sy+this.ey)/2-this.node_h/2),o.angle=-i),(!this.throw_audio_id||this.throw_audio_id&&1!=cc.audioEngine.getState(this.throw_audio_id))&&(this.throw_audio_id=cc.audioEngine.playEffect(this.throw_audio,!1))}this.pooled_fruits.forEach(function(e){if(e&&!e.isAvailable&&null!=e.fruit_all&&(console.log(JSON.stringify(t.prev_pos),",",JSON.stringify(t.curent_pos),",",JSON.stringify(e.fruit_all.getComponent("cc.PolygonCollider").world.points)),e.fruit_all.getComponent("cc.PolygonCollider")&&cc.Intersection.linePolygon(t.prev_pos,t.curent_pos,e.fruit_all.getComponent("cc.PolygonCollider").world.points)))if("boom"!=e.fruit_type){cc.audioEngine.playEffect(t.splatter_audio,!1),t.game_score++,t.scoreLabel.getComponent("cc.Label").string=t.game_score;var i=cc.instantiate(t.flash_prefab);i.position=e.fruit_all.position,i.rotation=n,t.node.addChild(i),setTimeout(function(){this.node.removeChild(i)}.bind(t),100),e.apart()}else e.apart(),t.boomIsBoom(e,e.fruit_all.x+t.node_w/2,e.fruit_all.y+t.node_h/2)}),this.finishNode.active&&cc.Intersection.linePolygon(this.prev_pos,this.curent_pos,this.tryagain.getComponent("cc.PolygonCollider").world.points)&&(cc.audioEngine.playEffect(this.splatter_audio,!1),this.prepare_game_start())},start:function(){this.menu_audio_id=cc.audioEngine.play(this.menu_audio,!1),this.prev_pos=null,this.curent_pos=null,cc.audioEngine.playEffect(this.splatter_audio,!1),this.prepare_game_start()},update:function(t){var e=this;this.global_timer+=t,this._rotation++,this.pooled_knifves.forEach(function(t){!t.getComponent("knife").isActivate&&t.getComponent("knife").life<=0&&(e.node.removeChild(t),t.getComponent("knife").resetProperties())}),this.pooled_fruits.forEach(function(i){i.isAvailable||(i.isActivate?i.update(t):(i.isBroken||"boom"!=i.fruit_type&&(e.fruit_missed++,e.precess_fruit_missed()),i.fruit_destroy(),i.isAvailable=!0))})},getPooledKnife:function(){for(var t=0;t<this.num_pooled_knifves;t++)if(this.pooled_knifves[t].getComponent("knife").isActivate)return this.pooled_knifves[t].getComponent("knife").isActivate=!1,this.pooled_knifves[t];var e=cc.instantiate(this.knife_part);return this.pooled_knifves.push(e),e.getComponent("knife").isActivate=!1,this.num_pooled_knifves++,e},onTouchStart:function(t){this.prev_pos=t.getLocation(),this.sx=t.getLocationX(),this.sy=t.getLocationY();var e=this.getPooledKnife();this.node.addChild(e),e.setPosition(this.sx-this.node_w/2,this.sy-this.node_h/2),console.log("this.prev_pos x=",this.prev_pos.x,",y=",this.prev_pos.y)},onTouchMove:function(t){var e=this;this.curent_pos=t.getLocation(),this.ex=t.getLocationX(),this.ey=t.getLocationY(),this.curent_pos=t.getLocation(),this.ex=t.getLocationX(),this.ey=t.getLocationY();var i=this.curent_pos.sub(this.prev_pos).mag(),n=0,s=this.curent_pos.sub(this.prev_pos).signAngle(cc.v2(1,0))/Math.PI*180;if(i>this.knife_height){var o=cc.v2(0,10);n=this.curent_pos.sub(this.prev_pos).signAngle(o)/Math.PI*180;var a=this.getPooledKnife();null!=a&&(this.node.addChild(a),a.height=i,a.setPosition((this.sx+this.ex)/2-this.node_w/2,(this.sy+this.ey)/2-this.node_h/2),a.angle=-n),this.prev_pos=this.curent_pos,this.sx=this.ex,this.sy=this.ey,(!this.throw_audio_id||this.throw_audio_id&&1!=cc.audioEngine.getState(this.throw_audio_id))&&(this.throw_audio_id=cc.audioEngine.playEffect(this.throw_audio,!1))}this.pooled_fruits.forEach(function(t){if(t&&!t.isAvailable&&null!=t.fruit_all&&(t.fruit_all.getComponent("cc.PolygonCollider")&&cc.Intersection.pointInPolygon(e.curent_pos,t.fruit_all.getComponent("cc.PolygonCollider").world.points)||t.fruit_all.getComponent("cc.CircleCollider")&&cc.Intersection.polygonCircle([e.curent_pos],t.fruit_all.getComponent("cc.CircleCollider").world))&&"boom"!=t.fruit_type){cc.audioEngine.playEffect(e.splatter_audio,!1),e.game_score++,e.scoreLabel.getComponent("cc.Label").string=e.game_score;var i=cc.instantiate(e.flash_prefab);i.position=t.fruit_all.position,i.rotation=s,e.node.addChild(i),setTimeout(function(){this.node.removeChild(i)}.bind(e),100),t.apart()}}),this.finishNode.active&&cc.Intersection.pointInPolygon(this.curent_pos,this.tryagain.getComponent("cc.PolygonCollider").world.points)&&(cc.audioEngine.playEffect(this.splatter_audio,!1),this.prepare_game_start())},prepare_game_start:function(){this.finishNode.active=!1,this.tryagain.active=!1,this.game_score=0,this.scoreLabel.getComponent("cc.Label").string=this.game_score,cc.audioEngine.stopAll(),this.prg.unscheduleAllCallbacks(),this.unscheduleAllCallbacks(),this.prg.progress=1,this.prg.unscheduleAllCallbacks(),n.uiUtils.showProgressBarChange(this.prg,1,0,120,this.timeCheckFinish.bind(this)),cc.audioEngine.play(this.start_audio),this.schedule_func=function(){for(var t=Math.floor(4*Math.random()),e=!1;t--;)"boom"==this.getPooledFruit(e).fruit_type&&(e=!1)},this.schedule(this.schedule_func.bind(this),2.5)},timeCheckFinish:function(){this.unscheduleAllCallbacks(),this.finishNode.active=!0,this.tryagain.active=!0,this.finishScore.getComponent(cc.Label).string=this.game_score},createFruit:function(t,e,n,s,o,a){var r=new i;return r.game_manager=this,"none"==t?r:(r.set_properties(t,cc.instantiate(this.config[t][0]),cc.instantiate(this.config[t][1]),cc.instantiate(this.config[t][2]),s,e,n,o,a),r)},getPooledFruit:function(){for(var t=0;t<this.num_pooled_fruits;t++)if(this.pooled_fruits[t].isAvailable){var e=Math.floor(12*Math.random());this.pooled_fruits[t].reset_all_properties(),this.pooled_fruits[t].isActivate=!0,this.pooled_fruits[t].isAvailable=!1;var i=this.fruit_type[e],n=Math.random()>.5?1:-1,s=Math.random()*(this.background.x+this.background.width/2-2-(this.background.x-this.background.width/2+2)+1)+(this.background.x-this.background.width/2)+2,o=this.background.y-this.node_h/2+.01,a=2.1*Math.random()+.6;a=s<this.background.x?a:-a;var r=2*Math.random()+10.7;return"boom"!=i?this.pooled_fruits[t].set_properties(i,cc.instantiate(this.config[i][0]),cc.instantiate(this.config[i][1]),cc.instantiate(this.config[i][2]),n,s,o,a,r):this.pooled_fruits[t].set_properties(i,cc.instantiate(this.config[i][0]),this.config[i][1],this.config[i][2],n,s,o,a,r),this.pooled_fruits[t].game_manager=this,this.pooled_fruits[t]}cc.log("create new fruit");var c=this.createFruit("none");this.pooled_fruits.push(c),c.isActivate=!0,c.isAvailable=!1,c.game_manager=this,this.num_pooled_fruits++;var l=Math.floor(2*Math.random()+0),h=this.fruit_type[l],u=Math.random()>.5?1:-1,d=Math.random()*(this.background.x+this.node_w/2-50-(this.background.x-this.node_w/2+50)+1)+(this.background.x-this.node_w/2)+50,_=this.background.y-this.node_h/2,f=2.1*Math.random()+.6;f=d<this.background.x?f:-f;var p=2*Math.random()+10.7;return c.set_properties(h,cc.instantiate(this.config[h][0]),cc.instantiate(this.config[h][1]),cc.instantiate(this.config[h][2]),u,d,_,f,p),c},precess_fruit_missed:function(){this.fruit_missed>0&&this.fruit_missed,this.fruit_missed},game_over_and_restart:function(){},getPooledBoomFlame:function(t,e,i,n,o,a,r){for(var c=0;c<this.num_pooled_boom_flame;c++)if(this.pooled_boom_flame[c].active)return this.pooled_boom_flame[c].set_properties(t,e,i,n,o,a,r),this.pooled_boom_flame[c].active=!1,this.pooled_boom_flame[c];var l=new s;return this.pooled_boom_flame.push(l),this.num_pooled_boom_flame++,l.active=!1,l.set_properties(t,e,i,n,o,a,r),l},removePooledBoomFlame:function(){for(var t=0;t<this.num_pooled_boom_flame;t++)this.pooled_boom_flame[t].active||(this.pooled_boom_flame[t].remove_boom_flame(),this.pooled_boom_flame[t].active=!0)},createLight:function(t,e,i,n){var s=Math.PI*(n*i-2.5)/180,o=Math.PI*(n*i+2.5)/180,a=t+1074*Math.cos(s),r=e+1074*Math.sin(s),c=t+1074*Math.cos(o),l=e+1074*Math.sin(o),h=cc.instantiate(this.paint);this.node.addChild(h);var u=h.getComponent(cc.Graphics);cc.log(n),u.moveTo(t,e),u.lineTo(a,r),u.lineTo(c,l),u.close(),u.stroke(),u.fillColor=(new cc.Color).fromHEX("ffffff"),u.fill()},boomIsBoom:function(t,e,i){this.node.off(cc.Node.EventType.TOUCH_START,this.onTouchStart,this,!0),this.node.off(cc.Node.EventType.TOUCH_MOVE,this.onTouchMove,this,!0),this.unscheduleAllCallbacks();for(var n=[],s=0;s<10;s)n[s]=s++;n.sort(function(){return.5-Math.random()}),cc.audioEngine.playEffect(this.boom_audio,!1);var a=10,r=0,c=cc.instantiate(this.paint);for(this.node.addChild(c);a--;)cc.log(a),setTimeout(function(){o(e,i,36,n[this],c)}.bind(a),r+=110);setTimeout(function(){this.node.removeChild(c),c.destroy(),t.fruit_destroy(),this.blank_paint=cc.instantiate(this.paint),this.node.addChild(this.blank_paint),this.boom_is_broken=!0}.bind(this),r+=100),setTimeout(function(){this.blank_paint&&(this.node.removeChild(this.blank_paint),this.blank_paint.destroy()),this.game_over_and_restart()}.bind(this),r+=3e3)}}),cc._RF.pop()},{UIUtils:"UIUtils",fruit:"fruit"}],"use_v2.1-2.2.1_cc.Toggle_event":[function(t,e){"use strict";cc._RF.push(e,"67c38B3qENAbYPom330yBd0","use_v2.1-2.2.1_cc.Toggle_event"),cc.Toggle&&(cc.Toggle._triggerEventInScript_isChecked=!0),cc._RF.pop()},{}]},{},["use_v2.1-2.2.1_cc.Toggle_event","AudioControl","BackgroundAdapter","ContentAdapter","LoadingNode","Main","UIUtils","Utils","fruit","knife","start"]);